# ğŸ“Š DIAGRAMA DE FLUXO - INTEGRAÃ‡ÃƒO COMPLETA SOLOFORTE

**Data:** 27 de outubro de 2025  
**Objetivo:** Visualizar como todos os mÃ³dulos se conectam

---

## ğŸ—ºï¸ VISÃƒO GERAL DO SISTEMA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SOLOFORTE - INTEGRAÃ‡ÃƒO                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                 â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   FRONT-END    â”‚              â”‚    BACKEND      â”‚
            â”‚   (React)      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   (Supabase)    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚           â”‚           â”‚            â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
   â”‚ CLIENTESâ”‚ â”‚  MAPA  â”‚ â”‚ SCANNER â”‚ â”‚CHECK-IN  â”‚
   â”‚         â”‚ â”‚        â”‚ â”‚ PRAGAS  â”‚ â”‚          â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚          â”‚           â”‚            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚   RELATÃ“RIOS   â”‚
               â”‚                â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ FLUXO 1: CADASTRO DE TALHÃƒO

```
TÃ‰CNICO ACESSA PRODUTOR
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TELA: Clientes.tsx             â”‚
â”‚  Seleciona: JoÃ£o Silva          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AÃ‡ÃƒO: Clica "Desenhar TalhÃ£o" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TELA: MapDrawing.tsx           â”‚
â”‚  Contexto:                      â”‚
â”‚    - produtorId: 'prod-001'     â”‚
â”‚    - produtorNome: 'JoÃ£o Silva' â”‚
â”‚    - fazenda: 'Boa Vista'       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TÃ‰CNICO DESENHA POLÃGONO       â”‚
â”‚    - Clica pontos no mapa       â”‚
â”‚    - Define contorno            â”‚
â”‚    - Sistema calcula Ã¡rea       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FORMULÃRIO:                    â”‚
â”‚    âœ“ Nome: "TalhÃ£o A"           â”‚
â”‚    âœ“ Cultura: "Soja"            â”‚
â”‚    âœ“ Ãrea: 50 ha (auto)         â”‚
â”‚    âœ“ Produtor: JoÃ£o Silva âœ“     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SALVAR â†’ GERA MINIATURA        â”‚
â”‚                                 â”‚
â”‚  generatePolygonThumbnail()     â”‚
â”‚    â†“                            â”‚
â”‚  [ğŸ—ºï¸ Imagem 300x200]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SALVO NO LOCALSTORAGE:         â”‚
â”‚                                 â”‚
â”‚  {                              â”‚
â”‚    id: 'talhao-001',            â”‚
â”‚    produtorId: 'prod-001', âœ“    â”‚
â”‚    produtorNome: 'JoÃ£o Silva',  â”‚
â”‚    nome: 'TalhÃ£o A',            â”‚
â”‚    area: 50,                    â”‚
â”‚    cultura: 'Soja',             â”‚
â”‚    thumbnail: 'data:image...'âœ“  â”‚
â”‚  }                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TELA DO PRODUTOR ATUALIZA      â”‚
â”‚                                 â”‚
â”‚  TALHÃ•ES (1)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [ğŸ—ºï¸ Miniatura]            â”‚ â”‚
â”‚  â”‚ TalhÃ£o A â€¢ 50 ha â€¢ Soja   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› FLUXO 2: REGISTRO DE PRAGA COM SCANNER IA

```
TÃ‰CNICO ESTÃ EM VISITA
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CHECK-IN ATIVO:                â”‚
â”‚    - produtorId: 'prod-001'     â”‚
â”‚    - checkInId: 'checkin-001'   â”‚
â”‚    - GPS: -23.55, -46.63        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ENCONTRA PRAGA NO CAMPO        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ABRE: PestScanner.tsx          â”‚
â”‚  Sistema detecta:               â”‚
â”‚    âœ“ Check-in ativo             â”‚
â”‚    âœ“ Produtor: JoÃ£o Silva       â”‚
â”‚    âœ“ GPS: dentro TalhÃ£o A       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TÃ‰CNICO TIRA FOTO              â”‚
â”‚    - Captura imagem da praga    â”‚
â”‚    - GPS automÃ¡tico             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IA ANALISA (GPT-4 Vision)      â”‚
â”‚    â†“                            â”‚
â”‚  Resultado:                     â”‚
â”‚    - Nome: "Spodoptera frugiperda"
â”‚    - Nome comum: "Lagarta"      â”‚
â”‚    - Severidade: Alta           â”‚
â”‚    - RecomendaÃ§Ã£o: "Inseticida X"â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SISTEMA CRIA OCORRÃŠNCIA        â”‚
â”‚                                 â”‚
â”‚  Auto-preenchido:               â”‚
â”‚    âœ“ produtorId: 'prod-001'     â”‚
â”‚    âœ“ talhaoId: 'talhao-001'     â”‚
â”‚    âœ“ checkInId: 'checkin-001'   â”‚
â”‚    âœ“ GPS: -23.55, -46.63        â”‚
â”‚    âœ“ tipo: 'inseto'             â”‚
â”‚    âœ“ severidade: 'alta'         â”‚
â”‚    âœ“ fotos: [foto1.jpg]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GERA MINIATURA DO PIN          â”‚
â”‚                                 â”‚
â”‚  generateOccurrenceThumbnail()  â”‚
â”‚    â†“                            â”‚
â”‚  [ğŸ“ Pin vermelho no mapa]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SALVO:                         â”‚
â”‚  {                              â”‚
â”‚    id: 'occ-001',               â”‚
â”‚    produtorId: 'prod-001', âœ“    â”‚
â”‚    talhaoId: 'talhao-001', âœ“    â”‚
â”‚    checkInId: 'checkin-001', âœ“  â”‚
â”‚    tipo: 'inseto',              â”‚
â”‚    severidade: 'alta',          â”‚
â”‚    fotos: ['foto1.jpg'],        â”‚
â”‚    thumbnail: 'data:image...'âœ“  â”‚
â”‚    pestDiagnosisId: 'diag-001'  â”‚
â”‚  }                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NOTIFICAÃ‡ÃƒO:                   â”‚
â”‚  "âœ“ Praga registrada no TalhÃ£o A"â”‚
â”‚  "âœ“ Vinculada Ã  visita"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ FLUXO 3: GERAÃ‡ÃƒO AUTOMÃTICA DE RELATÃ“RIO

```
TÃ‰CNICO FAZ CHECK-OUT
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CheckInOut.tsx                 â”‚
â”‚  BotÃ£o: "Finalizar Visita"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SISTEMA BUSCA DADOS DA VISITA: â”‚
â”‚                                 â”‚
â”‚  Check-in:                      â”‚
â”‚    - DuraÃ§Ã£o: 2h 30min          â”‚
â”‚    - Produtor: JoÃ£o Silva       â”‚
â”‚                                 â”‚
â”‚  TalhÃµes desenhados:            â”‚
â”‚    - TalhÃ£o A (50 ha)           â”‚
â”‚                                 â”‚
â”‚  OcorrÃªncias registradas:       â”‚
â”‚    - 1 Lagarta (Alta)           â”‚
â”‚    - 1 Ferrugem (MÃ©dia)         â”‚
â”‚                                 â”‚
â”‚  Fotos tiradas:                 â”‚
â”‚    - 3 fotos                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DIÃLOGO:                       â”‚
â”‚                                 â”‚
â”‚  "Deseja gerar relatÃ³rio        â”‚
â”‚   automÃ¡tico desta visita?"     â”‚
â”‚                                 â”‚
â”‚  [Sim]  [NÃ£o]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼ (UsuÃ¡rio clica Sim)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GERA RELATÃ“RIO COMPLETO        â”‚
â”‚                                 â”‚
â”‚  RelatorioCompleto {            â”‚
â”‚    id: 'rel-001',               â”‚
â”‚    tipo: 'visita',              â”‚
â”‚    produtorId: 'prod-001', âœ“    â”‚
â”‚    produtorNome: 'JoÃ£o Silva',  â”‚
â”‚    checkInId: 'checkin-001', âœ“  â”‚
â”‚    data: '2025-10-27',          â”‚
â”‚    duracao: 150, // minutos     â”‚
â”‚                                 â”‚
â”‚    talhoes: [{                  â”‚
â”‚      id: 'talhao-001',          â”‚
â”‚      nome: 'TalhÃ£o A',          â”‚
â”‚      area: 50,                  â”‚
â”‚      thumbnail: '...' âœ“         â”‚
â”‚    }],                          â”‚
â”‚                                 â”‚
â”‚    ocorrencias: [{              â”‚
â”‚      id: 'occ-001',             â”‚
â”‚      tipo: 'inseto',            â”‚
â”‚      severidade: 'alta',        â”‚
â”‚      fotos: [...],              â”‚
â”‚      thumbnail: '...' âœ“         â”‚
â”‚    }]                           â”‚
â”‚  }                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GERA MINIATURA GERAL           â”‚
â”‚                                 â”‚
â”‚  generateReportThumbnail()      â”‚
â”‚    â†“                            â”‚
â”‚  [ğŸ—ºï¸ Mapa com talhÃµes + pins]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SALVA RELATÃ“RIO                â”‚
â”‚  localStorage                   â”‚
â”‚  'soloforte_relatorios'         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ATUALIZA VÃNCULOS:             â”‚
â”‚                                 â”‚
â”‚  CheckIn.relatorioId = 'rel-001'â”‚
â”‚  Occurrence.relatorioIds += ['rel-001']
â”‚  Polygon.updatedAt = now        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NAVEGA PARA RELATÃ“RIO          â”‚
â”‚  RelatorioEditor.tsx            â”‚
â”‚                                 â”‚
â”‚  Mostra:                        â”‚
â”‚  - Header com dados produtor    â”‚
â”‚  - Miniaturas dos talhÃµes       â”‚
â”‚  - Pins das ocorrÃªncias         â”‚
â”‚  - Fotos da visita              â”‚
â”‚  - RecomendaÃ§Ãµes da IA          â”‚
â”‚  - OpÃ§Ã£o exportar PDF           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ‘¤ FLUXO 4: VISUALIZAR DADOS DO PRODUTOR

```
USUÃRIO ACESSA PRODUTOR
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Clientes.tsx                   â”‚
â”‚  Lista de produtores            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CLICA: JoÃ£o Silva              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SISTEMA BUSCA TODOS OS DADOS   â”‚
â”‚  VINCULADOS AO produtorId       â”‚
â”‚                                 â”‚
â”‚  Consultas:                     â”‚
â”‚  1. TalhÃµes (produtorId)        â”‚
â”‚  2. Check-ins (produtorId)      â”‚
â”‚  3. OcorrÃªncias (produtorId)    â”‚
â”‚  4. RelatÃ³rios (produtorId)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EXIBE TELA COMPLETA:           â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ JoÃ£o Silva                â”‚ â”‚
â”‚  â”‚ Fazenda Boa Vista         â”‚ â”‚
â”‚  â”‚ joao@email.com            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â”‚
â”‚  TALHÃ•ES (3)        [+ Novo]    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [ğŸ—ºï¸ Miniatura 300x200]    â”‚ â”‚
â”‚  â”‚ TalhÃ£o A                  â”‚ â”‚
â”‚  â”‚ 50 ha â€¢ Soja              â”‚ â”‚
â”‚  â”‚ 2 ocorrÃªncias ativas      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [ğŸ—ºï¸ Miniatura]            â”‚ â”‚
â”‚  â”‚ TalhÃ£o B                  â”‚ â”‚
â”‚  â”‚ 30 ha â€¢ Milho             â”‚ â”‚
â”‚  â”‚ Sem ocorrÃªncias           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â”‚
â”‚  VISITAS RECENTES               â”‚
â”‚  â€¢ 27/10 - 2h 30min â†’ [Ver]    â”‚
â”‚  â€¢ 20/10 - 1h 45min â†’ [Ver]    â”‚
â”‚                                 â”‚
â”‚  OCORRÃŠNCIAS ATIVAS (2)         â”‚
â”‚  ğŸ› Lagarta - TalhÃ£o A - Alta   â”‚
â”‚  ğŸƒ Ferrugem - TalhÃ£o A - MÃ©dia â”‚
â”‚                                 â”‚
â”‚  RELATÃ“RIOS (5)     [+ Novo]    â”‚
â”‚  â€¢ 27/10 - Visita TÃ©cnica â†’ [PDF]â”‚
â”‚  â€¢ 20/10 - AnÃ¡lise NDVI â†’ [PDF]â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— DIAGRAMA DE RELACIONAMENTOS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PRODUTOR                           â”‚
â”‚  id: 'prod-001'                                            â”‚
â”‚  nome: 'JoÃ£o Silva'                                        â”‚
â”‚  fazenda: 'Fazenda Boa Vista'                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚               â”‚               â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
     â”‚  TALHÃƒO 1  â”‚   â”‚ TALHÃƒO 2  â”‚   â”‚ TALHÃƒO 3  â”‚
     â”‚ TalhÃ£o A   â”‚   â”‚ TalhÃ£o B  â”‚   â”‚ TalhÃ£o C  â”‚
     â”‚ 50 ha      â”‚   â”‚ 30 ha     â”‚   â”‚ 45 ha     â”‚
     â”‚ [miniatura]â”‚   â”‚[miniatura]â”‚   â”‚[miniatura]â”‚
     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
     â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    OCORRÃŠNCIAS             â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ ğŸ› Lagarta (Alta)          â”‚
     â”‚    checkInId: 'c1'         â”‚
     â”‚    [miniatura pin]         â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ ğŸƒ Ferrugem (MÃ©dia)        â”‚
     â”‚    checkInId: 'c1'         â”‚
     â”‚    [miniatura pin]         â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    CHECK-IN (Visita)       â”‚
     â”‚ 27/10 - 2h 30min           â”‚
     â”‚ relatorioId: 'rel-001'     â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    RELATÃ“RIO               â”‚
     â”‚ Visita TÃ©cnica             â”‚
     â”‚                            â”‚
     â”‚ TalhÃµes: [T1, T2, T3]      â”‚
     â”‚ OcorrÃªncias: [O1, O2]      â”‚
     â”‚ [miniatura geral]          â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ STORAGE LAYOUT

### **LocalStorage Keys e VÃ­nculos:**

```
soloforte_produtores
  â†“
  [
    {
      id: 'prod-001',
      nome: 'JoÃ£o Silva',
      fazenda: 'Fazenda Boa Vista'
    }
  ]
        â”‚
        â”‚ (vinculado por produtorId)
        â”‚
        â”œâ”€â†’ soloforte_talhoes
        â”‚     [
        â”‚       {
        â”‚         id: 'talhao-001',
        â”‚         produtorId: 'prod-001', â†â”
        â”‚         nome: 'TalhÃ£o A',        â”‚
        â”‚         thumbnail: '...'         â”‚
        â”‚       }                          â”‚
        â”‚     ]                            â”‚
        â”‚                                  â”‚
        â”œâ”€â†’ soloforte_checkins             â”‚
        â”‚     [                            â”‚
        â”‚       {                          â”‚
        â”‚         id: 'checkin-001',       â”‚
        â”‚         produtorId: 'prod-001', â†â”¤
        â”‚         talhaoId: 'talhao-001' â”€â”€â”˜
        â”‚       }
        â”‚     ]
        â”‚
        â”œâ”€â†’ soloforte_demo_markers
        â”‚     [
        â”‚       {
        â”‚         id: 'occ-001',
        â”‚         produtorId: 'prod-001', â†â”
        â”‚         talhaoId: 'talhao-001', â”€â”¤
        â”‚         checkInId: 'checkin-001',â”‚
        â”‚         thumbnail: '...'         â”‚
        â”‚       }                          â”‚
        â”‚     ]                            â”‚
        â”‚                                  â”‚
        â””â”€â†’ soloforte_relatorios           â”‚
              [                            â”‚
                {                          â”‚
                  id: 'rel-001',           â”‚
                  produtorId: 'prod-001', â†â”¤
                  checkInId: 'checkin-001',â”‚
                  talhoes: ['talhao-001'],â”€â”¤
                  ocorrencias: ['occ-001'] â”‚
                }                          â”‚
              ]                            â”‚
                                           â”‚
              (Todos vinculados!)          â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”˜
```

---

## ğŸ¯ EXEMPLO REAL DE DADOS INTEGRADOS

```json
{
  "produtor": {
    "id": "prod-001",
    "nome": "JoÃ£o Silva",
    "fazenda": "Fazenda Boa Vista",
    "email": "joao@email.com"
  },
  
  "talhoes": [
    {
      "id": "talhao-001",
      "produtorId": "prod-001",           // â† VINCULADO
      "produtorNome": "JoÃ£o Silva",
      "nome": "TalhÃ£o A",
      "area": 50,
      "cultura": "Soja",
      "thumbnail": "data:image/jpeg;base64,/9j/4AAQ...",
      "points": [...]
    }
  ],
  
  "checkins": [
    {
      "id": "checkin-001",
      "produtorId": "prod-001",           // â† VINCULADO
      "produtorNome": "JoÃ£o Silva",
      "talhaoId": "talhao-001",           // â† VINCULADO
      "checkInTime": "2025-10-27T08:00:00",
      "checkOutTime": "2025-10-27T10:30:00",
      "duration": 150,
      "relatorioId": "rel-001",           // â† VINCULADO
      "ocorrenciaIds": ["occ-001", "occ-002"]
    }
  ],
  
  "ocorrencias": [
    {
      "id": "occ-001",
      "produtorId": "prod-001",           // â† VINCULADO
      "produtorNome": "JoÃ£o Silva",
      "talhaoId": "talhao-001",           // â† VINCULADO
      "talhaoNome": "TalhÃ£o A",
      "checkInId": "checkin-001",         // â† VINCULADO
      "tipo": "inseto",
      "severidade": "alta",
      "fotos": ["foto1.jpg"],
      "thumbnail": "data:image/jpeg;base64,iVBOR...",
      "pestDiagnosisId": "diag-001",
      "relatorioIds": ["rel-001"]         // â† VINCULADO
    }
  ],
  
  "relatorios": [
    {
      "id": "rel-001",
      "tipo": "visita",
      "produtorId": "prod-001",           // â† VINCULADO
      "produtorNome": "JoÃ£o Silva",
      "checkInId": "checkin-001",         // â† VINCULADO
      "talhoes": [
        {
          "id": "talhao-001",
          "nome": "TalhÃ£o A",
          "area": 50,
          "thumbnail": "data:image/jpeg;base64,/9j..."
        }
      ],
      "ocorrencias": [
        {
          "id": "occ-001",
          "tipo": "inseto",
          "severidade": "alta",
          "thumbnail": "data:image/jpeg;base64,iVB..."
        }
      ],
      "duracao": 150,
      "areaTotal": 50,
      "ocorrenciasTotal": 1
    }
  ]
}
```

---

## âœ… CHECKLIST DE INTEGRAÃ‡ÃƒO

### **Dados Vinculados:**
- [x] TalhÃ£o â†’ Produtor
- [x] OcorrÃªncia â†’ Produtor
- [x] OcorrÃªncia â†’ TalhÃ£o
- [x] OcorrÃªncia â†’ Check-in
- [x] Check-in â†’ Produtor
- [x] Check-in â†’ RelatÃ³rio
- [x] RelatÃ³rio â†’ Produtor
- [x] RelatÃ³rio â†’ TalhÃµes
- [x] RelatÃ³rio â†’ OcorrÃªncias

### **Miniaturas Geradas:**
- [x] TalhÃ£o (polÃ­gono)
- [x] OcorrÃªncia (pin no mapa)
- [x] RelatÃ³rio (visÃ£o geral)

### **Fluxos Implementados:**
- [x] Desenhar talhÃ£o vinculado
- [x] Escanear praga vinculada
- [x] Check-in com rastreamento
- [x] RelatÃ³rio automÃ¡tico

---

**Status:** âœ… Arquitetura de IntegraÃ§Ã£o Completa  
**Data:** 27/10/2025  
**PrÃ³ximo:** Implementar nos componentes React
